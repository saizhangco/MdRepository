## 分布式的前世今生

### 大型主机
>1 大型主机复杂性高，培养一个能够熟练运维大型主机的人成本很高。  
>2 大型主机很贵，一般只有土豪机构（政府、电信、金融）才能用得起。  
>3 会有单点问题，一旦大型主机出现故障，那整个系统就将处于不可用的状态。而对于大型主机的使用机构来说，这种不可用导致的损失是非常巨大的。

### 小型机、普通PC
>1 升级单机处理能力的性价比运来越低。  
2 单机处理能力存在瓶颈。  
3 稳定性和可用性这两个指标很难达到。  
4 单机系统存在可用性和稳定性的问题，这两个指标是我们亟待解决的问题。

### 集群
>多台设备做同样的事情，只有其中一台设备将会为具体的某一个终端提供服务。

### 分布式
>出现了分工，每台设备提供其中一项子服务，多台设备提供为终端提供服务。  
>**节点**：一个可以独立按照分布式协议完成一组逻辑的程序个体。一个节点表示一个操作系统上的进程。  
>**副本**：在分布式系统中为数据或服务提供的冗余。数据副本是分布式系统中解决数据丢失问题的唯一手段。服务副本表示多个节点提供相同的服务，通过主从关系来实现服务高可用的方案。  
> **中间件**：位于应用和系统层之间的、为开发者方便的处理通信、输入输出的一类软件，能够让用户只关心自己应用的部分。

### 架构
> **三态**：分布式系统的每一次请求与响应，存在特有的“三态”概念，即成功、失败与超时。  
> **分布式事务**  
> **一致性**  
> **故障独立性**

### 分布式系统挑战
> 第一，异构的机器与网络；  
> 第二，普遍的节点故障；  
> 第三，不可靠的网络；

### 分布式相关技术
> **负载均衡**  
> Nginx：高性能、高并发的web服务器；功能包括负载均衡、反向代理、静态内容缓存、访问控制；工作在应用层。  
> LVS：Linux virtual server，基于集群技术和Linux操作系统实现一个高性能、高可用的服务器；工作在网络层。  
 **WebServer**
> Java：Tomcat、Apache、Jboss
> Python：gunicorn、uwsgi、twisted、webpy、tornado  
 **Service**
> SOA、微服务、SpringBoot、Django  
 **容器**
> docker、kubernetes  
 **Cache**
> memcache、Redis  
 **协调中心**
> zookeeper、etcd  
 **RPC框架**
> grpc、dubbo、brpc  
> dubbo是阿里开源的Java语言开发的高性能RPC框架，在阿里系的诸多系统中，都是用了dubbo + spring boot  
 **消息队列**
> kafka、rabbitMQ、rocketMQ、QSP  
> 消息队列的应用场景：异步处理、应用解耦、流量削峰和消息通信  
> **实时数据平台**
> storm, akka  
 **离线数据平台**
> hadoop, spark  
 **dbproxy** cobar也是阿里开源的，在阿里系中使用也是非常广泛，是关系型数据库的sharding + replica代理  
 **DB**
> MySQL，Oracle、MongoDB、HBase  
 **搜索** elasticsearch、solr  
 **日志** rsyslog、elk、flume


## 消息队列 MessageQueue
**为什么使用消息队列啊？消息队列有什么优点和缺点啊？kafka、activemq、rabbitmq、rocketmq都有什么区别以及适应哪些场景？**
>消息队列的常见使用场景：解耦、异步、削峰。

消息队列的优缺点？
>优点：解耦、异步、削峰。
>>缺点：系统可用性降低、系统复杂性提高、一致性问题。

**kafka、activemq、rabbitmq、rocketmq比较**

| 特性 | ActiveMQ | RabbitMQ | RocketMQ | Kafka |
| ------ | ------ | ------ | ------ | ------|
| 单机吞吐量 | 万级 | 万级 | 10万级，RocketMQ也是一种可以支撑高吞吐的一种MQ | 10万级，这是Kafka最大的优点，就是吞吐量高。一般配合大数据类的系统来进行实时计算、日志采集等场景。
| topic数量对吞吐量的影响 |  |  | topic可以达到几百，几千个的级别，吞吐量会有较小幅度的下降。这是RocketMQ的一大优势，在同等机器下，可以支撑大量的topic。 | topic从几十个到几百个的时候，吞吐量会大幅度下降。所以在同等机器下，Kafka尽量保证topic数量不要过多。如果要支撑大规模topic，需要增加更多的机器资源。 |
| 时效性 | ms级 | 微妙级，这是rabbitmq的一大特点，延迟是最低的 | ms级 | 延迟在ms级以内 |
| 可用性 | 高，基于主从架构实现高可用性 | 高，基于主从架构实现高可用性 | 非常高，分布式架构 | 非常高，kafka是分布式的，一个数据多个副本，少数机器宕机，不会丢失数据，不会导致不可用 |
| 消息可靠性 | 有较低的概率丢失数据 |  | 经过参数优化配置，可以做到0丢失 | 经过参数优化配置，消息可以做到0丢失 |
| 功能支持 | MQ领域的功能极其完备 | 基于erlang开发，所以并发能力很强，性能极其好，延时很低 | MQ功能较为完善，还是分布式的，扩展性好 | 功能较为简单，主要支持简单的MQ功能，在大数据领域的实时计算以及日志采集被大规模使用，是事实上的标准 |

**如何保证消息队列的高可用？**

**如何保证消息不被重复消费（如何保证消息消费时的幂等性）？**
 
**如何保证消息的可靠性传输（如何处理消息丢失的问题）？**
**如何保证消息的顺序性？**
**如何解决消息队列的延时以及过期失效问题？消息队列满了以后该怎么处理？有几百万消息持续积压几个小时，说说怎么解决？**
**如果让你写一个消息队列，该如何进行架构设计？**
## 分布式缓存 Redis
## 分布式协调 Zookeeper